 cm omega =    131.85700000000000      thetacm =    60.000000000000000     
 
 x polarization - epsilon=<1,0,0>
        (-330386.33613795158,3.53869428678920076E-005) ,sigmax(twoMzp,twoMz)=               (0.0000000000000000,0.0000000000000000)
              (111938185.95300187,-1.0512137118190237) ,sigmax(twoMzp,twoMz)=               (1.0000000000000000,0.0000000000000000)
               (0.0000000000000000,0.0000000000000000) ,sigmax(twoMzp,twoMz)=               (1.0000000000000000,0.0000000000000000)
               (0.0000000000000000,0.0000000000000000) ,sigmax(twoMzp,twoMz)=               (0.0000000000000000,0.0000000000000000)
 
 y polarization - epsilon=<0,1,0>
       (1.64309339675491469E-007,-0.65395181544795211) sigmay(twoMzp,twoMz)=               (0.0000000000000000,0.0000000000000000)
  (-6.64424401503225946E-008,2.15351975895830289E-003) sigmay(twoMzp,twoMz)=              (0.0000000000000000,-1.0000000000000000)
               (0.0000000000000000,0.0000000000000000) sigmay(twoMzp,twoMz)=               (0.0000000000000000,1.0000000000000000)
               (0.0000000000000000,0.0000000000000000) sigmay(twoMzp,twoMz)=               (0.0000000000000000,0.0000000000000000)
 
 Order of outputs is
        twoMzp       twoMz
           1           1
           1          -1
          -1           1
          -1          -1
 

 ===================================================================================================
 Twobody Contributions to Few-Nucleon Neutral Pion photoproduction Calculated Via 2N-Density Matrix
 ===================================================================================================
 Alexander Long started 2023, modified from Compton scattering
    Compton code Version 1.0
       D. Phillips/A. Nogga/hgrie starting August 2020   
       based on 3He codes: D. Phillips/A. Nogga/hgrie starting May 2018
                           D. Phillips/B. Strasberg/hgrie starting June 2014
                           with A. Margaryan 2016-17, modifying codes by D. Shukla 2007/8

    Lowest beam energy           =    131.85700000000000      MeV
    Highest beam energy          =    131.85700000000000      MeV
    Energy step from low to high =    15.000000000000000      MeV
    Lowest theta                 =    60.000000000000000      deg
    Highest theta                =    60.000000000000000      deg
    Theta step from low to high  =    10.000000000000000      deg
 First take on output filename (placeholders to be replaced below): 
       3He-threshold-output.dat
 First take on density filename (placeholders to be replaced below): 
       /home/alex/OneDrive/densities-3He/2Ndensities/3He-59.98=theta-131.857=MeV-twobody.h5
   Target Nucleus: 3He, Anucl =  3, spin Snucl =  1/2 , mass Mnucl =  2808.400    MeV
 Input and output in centre-of-mass frame.
 Calculate  8 amplitudes with Mz(out)>0, find other  8 by Symmetry.
 Output in spherical basis of photon polarisations.
 O(e²delta²)=O(Q³) calculation. (12) subsystem is (pn) since only charged MECs.
 Integration parameters of (12) subsystem:
 Total angular momentum in (12) subsystem set to j12max =    1
 Radial Integration in (12) subsystem:
    total of NP12 = NP12A+NP12B =           10  points
    1 bin with hyperbolic map: (NP12A =  3) points:
       (NP12A/2 =  1) points in p12 interval [0; (P12A =     1.1000)] fm^-1
       (NP12A/2 =  1) points in p12 interval [(P12A =     1.1000);(P12B =     5.0000)] fm^-1
    1 bin with linear map: (NP12B= 7) points in p12 interval [(P12B =     5.0000);(P12C =    15.0000)] fm^-1
    NP12p == ( NP12A+NP12B =           10 ) cannot be dialled.
 Angular Integration in (12) subsystem
    by Lebedev-Laikov for theta & phi combined:
    ==> preliminary size of solid angle grid Nanggrid12(set to Nordth12) =    4 points.
    Nthbins12, Nordphi12, Nphibins12 have no meaning.
 ADDITIONAL COMMENTS:_v2.0
 Write output to file: 3He-threshold-output.dat
 LebedevLaikov:
   No solid angle grid size              4  available --
      Next larger one chosen:            6
           #   theta [deg], phi [deg], angular weight (sums to 4\pi)
           1   90.000000000000000        0.0000000000000000        2.0943951606750488     
           2   90.000000000000000        90.000000000000000        2.0943951606750488     
           3   90.000000000000000        180.00000000000000        2.0943951606750488     
           4   90.000000000000000        270.00000000000000        2.0943951606750488     
           5   0.0000000000000000        0.0000000000000000        2.0943951606750488     
           6   180.00000000000000        0.0000000000000000        2.0943951606750488     
 Sum of all angular weights (expect 4Pi) =    1.0000000000000000      *4Pi
 ***************************** END OF INITIALISATION *****************************
 cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
 cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc

 Incoming photon energy (rounded) =          131  MeV
 Number of Angles Nangles         =            1

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 Calculating amps: theta =   60.000000000000000      deg: angle #           1
 In main.twobodyvia2Ndensity.f: k=   131.87643593980371     
 In main.twobodyvia2Ndensity.f: omegaThreshold=   131.87543593975622     
    Now looking for density file...
    Density file name generated from energy & angle: /home/alex/OneDrive/densities-3He/2Ndensities/3He-59.98=theta-131.857=MeV-twobody.h5
       Density file exists, good.
 *********************** 2N DENSITY MATRIX PARAMETERS ***************************
 hdf tools version: 
 HDFinit: Using standard driver in HDF for all reading.
 HDFinit: Using standard driver in HDF for all writing.
 Initamp version: 
 P12 grid read in from file
p12 read parameters:  p1=   0.100000E+01 p2=   0.300000E+01 p3=   0.800000E+01 n1=   40 n2=   16 n_ges=   56
j12max_rho =    5
mjtot      =   -1...   1
        alpha  al2    l12  s12  j12  t12    mt12   m12 mjtot
 Sets in file:
 set number     energy [MeV]     scatt. angle [deg]
      1               131.86                59.98
    Finished reading bookkeeping information. Starting to read data sets.
 Finished reading dataset of 2Ndensity.
FF:    0.668014E+00   0.174396E-07   0.447501E+00   0.218828E+00   0.666329E+00
Calculation of rho for ...
  omega     =    0.131857E+03
  qval      =    0.131817E+03
  thetaval  =    0.599800E+02
  thetaqval =    0.119990E+03
    Energy and angle of 2Ndensity file match request.
      j12max     =    1
      j12max2N   =    5
    2Ndensity file covers requested j12max. Proceeding with j12max =    1
 *********Now convoluting 2N helicity amplitudes with 2N density matrix.*********
 
 x polarization - epsilon=<1,0,0>
        (-330386.33613795158,3.53869428678920076E-005) ,sigmax(twoMzp,twoMz)=               (0.0000000000000000,0.0000000000000000)
              (111938185.95300187,-1.0512137118190237) ,sigmax(twoMzp,twoMz)=               (1.0000000000000000,0.0000000000000000)
               (0.0000000000000000,0.0000000000000000) ,sigmax(twoMzp,twoMz)=               (1.0000000000000000,0.0000000000000000)
               (0.0000000000000000,0.0000000000000000) ,sigmax(twoMzp,twoMz)=               (0.0000000000000000,0.0000000000000000)
 
 y polarization - epsilon=<0,1,0>
       (1.64309339675491469E-007,-0.65395181544795211) sigmay(twoMzp,twoMz)=               (0.0000000000000000,0.0000000000000000)
  (-6.64424401503225946E-008,2.15351975895830289E-003) sigmay(twoMzp,twoMz)=              (0.0000000000000000,-1.0000000000000000)
               (0.0000000000000000,0.0000000000000000) sigmay(twoMzp,twoMz)=               (0.0000000000000000,1.0000000000000000)
               (0.0000000000000000,0.0000000000000000) sigmay(twoMzp,twoMz)=               (0.0000000000000000,0.0000000000000000)
 
 Order of outputs is
        twoMzp       twoMz
           1           1
           1          -1
          -1           1
          -1          -1
 
 Note the following code has not been checked for a full output to mathematica, and might need fixing
         {-.330386336137951585*10^(+06)+.353869428678920076*10^(-04)*I,+.164309339675491469*10^(-06)-.653951815447952112*10^(+00)*I,+.111938185953001872*10^(+09)-.105121371181902368*10^(+01)*I,-.664424401503225946*10^(-07)+.215351975895830289*10^(-02)*I,+.000000000000000000*10^(+00)+.000000000000000000*10^(+00)*I,+.000000000000000000*10^(+00)+.000000000000000000*10^(+00)*I,+.000000000000000000*10^(+00)+.000000000000000000*10^(+00)*I,+.000000000000000000*10^(+00)+.000000000000000000*10^(+00)*I}
 
 Lenkewitz Results at threshold https://arxiv.org/pdf/1103.3400.pdf
 cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
 F_T^a-F_T^b=-29.3 fm^-1=-5780.89 MeV for 3He
 F_L^a-F_L^b=-22.9 fm^-1=-4518.18 MeV for 3H 
 cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
 cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
 *** Wrote output to file: 3He-threshold-output.dat
Production date: 2023-09-04 08:26:57-04:00
Real Time used: 5 seconds on host along-desktop
**************************************************
*********            INPUT FILE          *********
**************************************************
131.857 131.857 15            omegaLow, omegaHigh, omegaStep
60 60 10                             thetaLow, thetaHigh, thetaStep
3He-threshold-output.dat
'/home/alex/OneDrive/densities-3He/2Ndensities/3He-59.98=theta-131.857=MeV-twobody.h5'
cm_ymmetry_verbos                     frame, symmetry, verbosity of STDOUT
Odelta2_j12max=1 		    Calctype, maximal total ang mom in (12) subsystem
3 7 		    		    NP12A, NP12B
1.1 5.0 15.0 			    P12A, P12B, P12C
2 4     			    AngularType12,(Nordth12 OR Nanggrid12),Nthbins12,Nordphi12,Nphibins12
COMMENTS:_v2.0
# in density filename, code replaces XXX and YYY automatically by energy and angle.
